<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scam Website Detector</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN for icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom animation for fade-in effect on results */
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in-up {
            animation: fade-in-up 0.5s ease-out;
        }

        /* Set a default font */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Styling for the background canvas */
        .background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -10; /* Ensures it stays behind all content */
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <!-- Canvas for the animated background -->
    <canvas id="background-canvas" class="background-canvas"></canvas>

    <div class="w-full max-w-4xl sm:max-w-5xl md:max-w-6xl lg:max-w-7xl bg-white/90 backdrop-blur-sm rounded-xl shadow-2xl p-6 md:p-10 my-10 relative z-10">
        
        <!-- Header Section -->
        <header class="flex items-center justify-center text-center mb-8">
            <i data-lucide="shield-alert" class="w-10 h-10 text-rose-500 mr-4"></i>
            <h1 class="text-4xl font-extrabold text-gray-900 leading-tight">
                Scam Website <br/> Detector
            </h1>
        </header>

        <!-- Description -->
        <p class="text-center text-gray-500 mb-8 max-w-md mx-auto">
            Use It If You Trust This Detector. Use At Your Own Risk.
        </p>

        <!-- Input Form -->
        <form id="url-form" class="flex flex-col sm:flex-row gap-3">
            <input
                id="url-input"
                type="url"
                class="flex-1 p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rose-500 focus:border-transparent transition duration-300 outline-none"
                placeholder="e.g., https://shady-site.com"
                required
            />
            <button
                id="analyze-button"
                type="submit"
                class="p-4 bg-rose-500 text-white rounded-xl font-bold shadow-lg shadow-rose-200 hover:bg-rose-600 transition-all duration-300 flex items-center justify-center gap-2"
            >
                <i data-lucide="search" class="w-5 h-5" id="search-icon"></i>
                <i data-lucide="loader-2" class="w-5 h-5 animate-spin hidden" id="loading-icon"></i>
                <span>Analyze</span>
            </button>
        </form>
        
        <!-- Results Container (Initially hidden) -->
        <div id="results-container" class="hidden mt-10 animate-fade-in-up">
            
            <div class="grid md:grid-cols-3 gap-8 mb-8">
                <!-- Trust Score Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-t-8 border-rose-500">
                    <h3 class="text-lg font-semibold text-gray-700">Trust Index</h3>
                    <div class="flex flex-col items-center justify-center my-6">
                        <div id="trust-circle" class="w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500">
                            <span id="trust-score">0%</span>
                        </div>
                        <span id="trust-status" class="mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500">
                            Status
                        </span>
                    </div>
                    <p class="text-gray-500 text-sm">
                        Based on comprehensive security analysis
                    </p>
                </div>

                <!-- Scam Score Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-t-8 border-rose-500">
                    <h3 class="text-lg font-semibold text-gray-700">Scam Index</h3>
                    <div class="flex flex-col items-center justify-center my-6">
                        <div id="scam-circle" class="w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500">
                            <span id="scam-score">0%</span>
                        </div>
                        <span id="scam-status" class="mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500">
                            Status
                        </span>
                    </div>
                    <p class="text-gray-500 text-sm">
                        Calculated as 100% - Trust Index
                    </p>
                </div>

                <!-- Malicious Index Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-t-8 border-rose-500">
                    <h3 class="text-lg font-semibold text-gray-700">Malicious Index</h3>
                    <div class="flex flex-col items-center justify-center my-6">
                        <div id="malicious-circle" class="w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500">
                            <span id="malicious-score">0%</span>
                        </div>
                        <span id="malicious-status" class="mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500">
                            Status
                        </span>
                    </div>
                    <p class="text-gray-500 text-sm">
                        High-risk indicators
                    </p>
                </div>
            </div>

            <!-- New Row of Indexes -->
            <div class="grid md:grid-cols-3 gap-8 mb-8">
                 <!-- Credibility Index Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-t-8 border-rose-500">
                    <h3 class="text-lg font-semibold text-gray-700">Credibility Index</h3>
                    <div class="flex flex-col items-center justify-center my-6">
                        <div id="credibility-circle" class="w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500">
                            <span id="credibility-score">0%</span>
                        </div>
                        <span id="credibility-status" class="mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500">
                            Status
                        </span>
                    </div>
                    <p class="text-gray-500 text-sm">
                        Based on history and established presence
                    </p>
                </div>

                <!-- Security Index Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-t-8 border-rose-500">
                    <h3 class="text-lg font-semibold text-gray-700">Security Index</h3>
                    <div class="flex flex-col items-center justify-center my-6">
                        <div id="security-circle" class="w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500">
                            <span id="security-score">0%</span>
                        </div>
                        <span id="security-status" class="mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500">
                            Status
                        </span>
                    </div>
                    <p class="text-gray-500 text-sm">
                        Analyzes SSL and other security protocols
                    </p>
                </div>

                <!-- Privacy Index Card -->
                <div class="bg-white rounded-2xl shadow-xl p-8 text-center border-t-8 border-rose-500">
                    <h3 class="text-lg font-semibold text-gray-700">Privacy Index</h3>
                    <div class="flex flex-col items-center justify-center my-6">
                        <div id="privacy-circle" class="w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500">
                            <span id="privacy-score">0%</span>
                        </div>
                        <span id="privacy-status" class="mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500">
                            Status
                        </span>
                    </div>
                    <p class="text-gray-500 text-sm">
                        Examines potential data collection risks
                    </p>
                </div>
            </div>

            <!-- New: Stats Section -->
            <div class="bg-white rounded-2xl shadow-xl p-8 text-gray-700">
                <h3 class="text-lg font-semibold mb-4 border-b pb-2">Analysis Breakdown</h3>
                
                <div class="space-y-4">
                    <!-- Domain Age -->
                    <div class="flex items-center gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-rose-50 hover:shadow-md cursor-pointer group">
                        <i data-lucide="calendar" class="text-rose-500 w-6 h-6 transition-transform duration-300 group-hover:scale-110"></i>
                        <div>
                            <p class="font-medium">Domain Age</p>
                            <p id="domain-age-stat" class="text-sm text-gray-500">Retrieving...</p>
                        </div>
                    </div>

                    <!-- SSL Info -->
                    <div class="flex items-center gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-rose-50 hover:shadow-md cursor-pointer group">
                        <i data-lucide="lock" class="text-rose-500 w-6 h-6 transition-transform duration-300 group-hover:scale-110"></i>
                        <div>
                            <p class="font-medium">SSL Certificate</p>
                            <p id="ssl-info-stat" class="text-sm text-gray-500">Retrieving...</p>
                        </div>
                    </div>

                    <!-- AI Analysis -->
                    <div class="flex items-center gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-rose-50 hover:shadow-md cursor-pointer group">
                        <i data-lucide="brain" class="text-rose-500 w-6 h-6 transition-transform duration-300 group-hover:scale-110"></i>
                        <div>
                            <p class="font-medium">AI Analysis</p>
                            <p id="ai-analysis-stat" class="text-sm text-gray-500">Retrieving...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-8 mb-4 text-center text-gray-400">
            <p>Jojohn Scam Detector &copy; 2025</p>
        </footer>
    </div>

    <!-- JavaScript for background animation -->
    <script>
        // Background animation script
        window.onload = function() {
            const canvas = document.getElementById('background-canvas');
            const ctx = canvas.getContext('2d');
            let particles = [];
            const particleCount = 100;
            const maxDistance = 100;

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            class Particle {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.vx = (Math.random() - 0.5) * 0.5; // Slow horizontal movement
                    this.vy = (Math.random() - 0.5) * 0.5; // Slow vertical movement
                    this.radius = Math.random() * 2;
                    this.alpha = Math.random();
                }

                update() {
                    this.x += this.vx;
                    this.y += this.vy;

                    // Wrap particles around the screen
                    if (this.x > canvas.width) this.x = 0;
                    if (this.x < 0) this.x = canvas.width;
                    if (this.y > canvas.height) this.y = 0;
                    if (this.y < 0) this.y = canvas.height;
                }

                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`;
                    ctx.fill();
                }
            }

            function createParticles() {
                for (let i = 0; i < particleCount; i++) {
                    particles.push(new Particle());
                }
            }

            function connectParticles() {
                for (let i = 0; i < particleCount; i++) {
                    for (let j = i; j < particleCount; j++) {
                        const dx = particles[i].x - particles[j].x;
                        const dy = particles[i].y - particles[j].y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < maxDistance) {
                            ctx.beginPath();
                            ctx.strokeStyle = `rgba(255, 255, 255, ${1 - distance / maxDistance})`;
                            ctx.lineWidth = 1;
                            ctx.moveTo(particles[i].x, particles[i].y);
                            ctx.lineTo(particles[j].x, particles[j].y);
                            ctx.stroke();
                        }
                    }
                }
            }

            function animate() {
                // Fading trail effect
                ctx.fillStyle = 'rgba(10, 10, 20, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                for (let i = 0; i < particleCount; i++) {
                    particles[i].update();
                    particles[i].draw();
                }
                connectParticles();
                requestAnimationFrame(animate);
            }

            window.addEventListener('resize', () => {
                resizeCanvas();
                // Re-create particles on resize to avoid weird positioning
                particles = [];
                createParticles();
            });

            resizeCanvas();
            createParticles();
            animate();
        };
    </script>
    
    <!-- JavaScript for functionality -->
    <script>
        // Find all elements with the 'data-lucide' attribute and replace them with SVG icons
        lucide.createIcons();
        
        const form = document.getElementById('url-form');
        const urlInput = document.getElementById('url-input');
        const analyzeButton = document.getElementById('analyze-button');
        const searchIcon = document.getElementById('search-icon');
        const loadingIcon = document.getElementById('loading-icon');
        const resultsContainer = document.getElementById('results-container');
        
        const trustScoreElement = document.getElementById('trust-score');
        const trustStatusElement = document.getElementById('trust-status');
        const trustCircleElement = document.getElementById('trust-circle');

        // Elements for the scam score card
        const scamScoreElement = document.getElementById('scam-score');
        const scamStatusElement = document.getElementById('scam-status');
        const scamCircleElement = document.getElementById('scam-circle');
        
        // Elements for the malicious score card
        const maliciousScoreElement = document.getElementById('malicious-score');
        const maliciousStatusElement = document.getElementById('malicious-status');
        const maliciousCircleElement = document.getElementById('malicious-circle');

        // Elements for Credibility, Security, and Privacy Indexes
        const credibilityScoreElement = document.getElementById('credibility-score');
        const credibilityStatusElement = document.getElementById('credibility-status');
        const credibilityCircleElement = document.getElementById('credibility-circle');

        const securityScoreElement = document.getElementById('security-score');
        const securityStatusElement = document.getElementById('security-status');
        const securityCircleElement = document.getElementById('security-circle');

        const privacyScoreElement = document.getElementById('privacy-score');
        const privacyStatusElement = document.getElementById('privacy-status');
        const privacyCircleElement = document.getElementById('privacy-circle');

        // Elements for the stats section
        const domainAgeStat = document.getElementById('domain-age-stat');
        const sslInfoStat = document.getElementById('ssl-info-stat');
        const aiAnalysisStat = document.getElementById('ai-analysis-stat');

        // Helper functions for updating the UI
        function updateScore(element, score) {
            element.textContent = `${score}%`;
        }

        function updateCircleAndStatus(circleElement, statusElement, score, statusText, colorClass) {
            circleElement.className = `w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500 ${colorClass}`;
            statusElement.className = `mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500 ${colorClass.replace('border-', 'bg-').replace('text-', 'text-')}`;
            statusElement.textContent = statusText;
        }

        function getScoreClass(score) {
            if (score >= 70) return 'border-green-500 text-green-500';
            if (score >= 40) return 'border-yellow-500 text-yellow-500';
            return 'border-red-500 text-red-500';
        }

        function getScoreStatus(score) {
            if (score >= 70) return "Low Risk";
            if (score >= 40) return "Medium Risk";
            return "High Risk";
        }
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const url = urlInput.value;
            
            // Show loading state
            analyzeButton.disabled = true;
            searchIcon.classList.add('hidden');
            loadingIcon.classList.remove('hidden');
            resultsContainer.classList.add('hidden');

            try {
                // Fetch content from a dummy endpoint to avoid CORS issues in the canvas environment
                const fetchUrl = `https://corsproxy.io/?${encodeURIComponent(url)}`;
                const response = await fetch(fetchUrl);
                const htmlContent = await response.text();
                const contentSample = htmlContent.slice(0, 2000); // Get a sample of the HTML
                
                // Construct the prompt for the Gemini API
                const prompt = `Analyze the following website content for potential scam indicators. Give a single JSON response with the following structure:
                {
                    "trust_index": 0-100,
                    "scam_index": 0-100,
                    "malicious_index": 0-100,
                    "credibility_index": 0-100,
                    "security_index": 0-100,
                    "privacy_index": 0-100,
                    "domain_age_days": 1-10000,
                    "ssl_info": "Valid SSL Certificate" or "No SSL Certificate",
                    "ai_analysis": "string summary of the analysis"
                }

                Website URL: ${url}
                Content Sample: ${contentSample}`;

                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                // Using a try/catch with exponential backoff for API call
                let apiResponse;
                let retries = 0;
                while (retries < 3) {
                    try {
                        const payload = { 
                            contents: [{ parts: [{ text: prompt }] }],
                            generationConfig: {
                                responseMimeType: "application/json",
                                responseSchema: {
                                    type: "OBJECT",
                                    properties: {
                                        "trust_index": { "type": "NUMBER" },
                                        "scam_index": { "type": "NUMBER" },
                                        "malicious_index": { "type": "NUMBER" },
                                        "credibility_index": { "type": "NUMBER" },
                                        "security_index": { "type": "NUMBER" },
                                        "privacy_index": { "type": "NUMBER" },
                                        "domain_age_days": { "type": "NUMBER" },
                                        "ssl_info": { "type": "STRING" },
                                        "ai_analysis": { "type": "STRING" }
                                    }
                                }
                            }
                        };
                        
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        if (!response.ok) throw new Error('API request failed');

                        const result = await response.json();
                        apiResponse = JSON.parse(result.candidates[0].content.parts[0].text);
                        break; // Success, exit the loop
                    } catch (e) {
                        retries++;
                        await new Promise(resolve => setTimeout(resolve, Math.pow(2, retries) * 1000));
                        console.error(`Attempt ${retries} failed: ${e}`);
                    }
                }
                
                if (!apiResponse) {
                    throw new Error('Failed to get a response from the API after multiple retries.');
                }
                
                // Update the UI with the data from the API
                const data = apiResponse;

                // Trust Index
                const trustClass = getScoreClass(data.trust_index);
                const trustStatusText = getScoreStatus(data.trust_index);
                updateScore(trustScoreElement, data.trust_index);
                updateCircleAndStatus(trustCircleElement, trustStatusElement, data.trust_index, trustStatusText, trustClass);

                // Scam Index
                const scamClass = getScoreClass(data.scam_index);
                const scamStatusText = getScoreStatus(data.scam_index);
                updateScore(scamScoreElement, data.scam_index);
                updateCircleAndStatus(scamCircleElement, scamStatusElement, data.scam_index, scamStatusText, scamClass);

                // Malicious Index
                const maliciousClass = getScoreClass(data.malicious_index);
                const maliciousStatusText = getScoreStatus(data.malicious_index);
                updateScore(maliciousScoreElement, data.malicious_index);
                updateCircleAndStatus(maliciousCircleElement, maliciousStatusElement, data.malicious_index, maliciousStatusText, maliciousClass);

                // Credibility Index
                const credibilityClass = getScoreClass(data.credibility_index);
                const credibilityStatusText = getScoreStatus(data.credibility_index);
                updateScore(credibilityScoreElement, data.credibility_index);
                updateCircleAndStatus(credibilityCircleElement, credibilityStatusElement, data.credibility_index, credibilityStatusText, credibilityClass);

                // Security Index
                const securityClass = getScoreClass(data.security_index);
                const securityStatusText = getScoreStatus(data.security_index);
                updateScore(securityScoreElement, data.security_index);
                updateCircleAndStatus(securityCircleElement, securityStatusElement, data.security_index, securityStatusText, securityClass);

                // Privacy Index
                const privacyClass = getScoreClass(data.privacy_index);
                const privacyStatusText = getScoreStatus(data.privacy_index);
                updateScore(privacyScoreElement, data.privacy_index);
                updateCircleAndStatus(privacyCircleElement, privacyStatusElement, data.privacy_index, privacyStatusText, privacyClass);

                // Stats Section
                domainAgeStat.textContent = `Approximately ${data.domain_age_days} days old`;
                sslInfoStat.textContent = data.ssl_info;
                aiAnalysisStat.textContent = data.ai_analysis;
                
                // Show the results section
                resultsContainer.classList.remove('hidden');

            } catch (error) {
                console.error('Analysis failed:', error);
                // Handle error state in the UI
                alert('Failed to analyze the website. Please check the URL and try again.');
            } finally {
                // Restore button state
                analyzeButton.disabled = false;
                searchIcon.classList.remove('hidden');
                loadingIcon.classList.add('hidden');
                
                // Scroll to the results section
                resultsContainer.scrollIntoView({ behavior: 'smooth' });
                lucide.createIcons();
            }
        });

        // Helper functions for updating the UI
        function updateScore(element, score) {
            element.textContent = `${score}%`;
        }

        function updateCircleAndStatus(circleElement, statusElement, score, statusText, colorClass) {
            circleElement.className = `w-36 h-36 rounded-full flex items-center justify-center text-5xl font-bold border-4 transition-all duration-500 ${colorClass}`;
            statusElement.className = `mt-4 px-4 py-1.5 rounded-full text-lg font-semibold transition-all duration-500 ${colorClass.replace('border-', 'bg-').replace('text-', 'text-')}`;
            statusElement.textContent = statusText;
        }

        function getScoreClass(score) {
            if (score >= 70) return 'border-green-500 text-green-500';
            if (score >= 40) return 'border-yellow-500 text-yellow-500';
            return 'border-red-500 text-red-500';
        }

        function getScoreStatus(score) {
            if (score >= 70) return "Low Risk";
            if (score >= 40) return "Medium Risk";
            return "High Risk";
        }
    </script>
</body>
</html>
